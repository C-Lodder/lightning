/**
 * @copyright  Copyright (C) 2020 - JoomJunk
 * @license    MIT; see LICENSE.txt
 */
import iro from"./iro.min.js";class ColourPicker extends HTMLElement{constructor(){super(),this.swatch="",this.input="",this.panel=""}connectedCallback(){this.classList.add("has-swatch"),this.swatch=document.createElement("colour-swatch"),this.panel=document.createElement("div"),this.panel.classList.add("panel"),this.appendChild(this.swatch),this.appendChild(this.panel),this.init()}init(){this.input=this.querySelector("input");const t=""!==this.input.value?this.input.value:this.input.closest("tr").querySelector(".css-default").value,s=new iro.ColorPicker(this.panel,{width:150,layoutDirection:"horizontal",color:t});s.on(["color:change"],(t=>{this.input.value=t.hslString,this.swatch.style.backgroundColor=t.hslString,this.input.dispatchEvent(new Event("input",{bubbles:!0}))})),s.on(["color:init"],(t=>{this.swatch.style.backgroundColor=this.input.value})),this.input.addEventListener("input",(({target:t})=>{s.color.hslString=t.value;const e=t.closest("tr");t.value!==e.querySelector(".css-default").value&&t.value!==t.getAttribute("data-default-value")||""!==t.value.trim()?e.classList.add("has-changed"):e.classList.remove("has-changed")})),this.swatch.addEventListener("click",(()=>{this.input.focus()})),this.input.addEventListener("focus",(()=>{this.panel.classList.contains("is-open")||this.panel.classList.add("is-open")})),this.input.addEventListener("blur",(()=>{this.panel.classList.remove("is-open")}))}}customElements.define("colour-picker",ColourPicker);